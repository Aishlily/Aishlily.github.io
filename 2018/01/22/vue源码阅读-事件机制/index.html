<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/love.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/love.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="笔记,JavaScript,vue," />










<meta name="description" content="事件机制demo：123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&amp;lt;div id=&quot;app&quot;&amp;gt;  &amp;lt;div id=&quot;test1&quot; @click=&quot;click1&quot;&amp;gt;click1&amp;lt;/div&amp;gt;  &amp;lt;di">
<meta name="keywords" content="笔记,JavaScript,vue">
<meta property="og:type" content="article">
<meta property="og:title" content="vue源码阅读-事件机制">
<meta property="og:url" content="/2018/01/22/vue源码阅读-事件机制/index.html">
<meta property="og:site_name" content="Aishlily&#39;s Blog">
<meta property="og:description" content="事件机制demo：123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&amp;lt;div id=&quot;app&quot;&amp;gt;  &amp;lt;div id=&quot;test1&quot; @click=&quot;click1&quot;&amp;gt;click1&amp;lt;/div&amp;gt;  &amp;lt;di">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-04-14T06:04:32.343Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="vue源码阅读-事件机制">
<meta name="twitter:description" content="事件机制demo：123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&amp;lt;div id=&quot;app&quot;&amp;gt;  &amp;lt;div id=&quot;test1&quot; @click=&quot;click1&quot;&amp;gt;click1&amp;lt;/div&amp;gt;  &amp;lt;di">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"right","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="/2018/01/22/vue源码阅读-事件机制/"/>





  <title>vue源码阅读-事件机制 | Aishlily's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Aishlily's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'urw61T1LFFwLwttU72jp','2.0.0');
</script>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="/2018/01/22/vue源码阅读-事件机制/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Aishlily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/my.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Aishlily's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">vue源码阅读-事件机制</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-22T12:55:45+08:00">
                2018-01-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vue/" itemprop="url" rel="index">
                    <span itemprop="name">vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="事件机制demo："><a href="#事件机制demo：" class="headerlink" title="事件机制demo："></a>事件机制demo：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">  &lt;div id=<span class="string">"test1"</span> @click=<span class="string">"click1"</span>&gt;click1&lt;/div&gt;</span><br><span class="line">  &lt;div id=<span class="string">"test2"</span> @click.stop=<span class="string">"click2"</span>&gt;click2&lt;/div&gt;</span><br><span class="line">  &lt;my-component v-on:click.native=<span class="string">"nativeclick"</span> v-on:componenton=<span class="string">"parentOn"</span>&gt;</span><br><span class="line">  &lt;/my-component&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=<span class="string">"vue.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">var Child = &#123;</span><br><span class="line">  template: <span class="string">'&lt;div&gt;A custom component!&lt;/div&gt;'</span></span><br><span class="line">&#125; </span><br><span class="line">Vue.component(<span class="string">'my-component'</span>, &#123;</span><br><span class="line">  name: <span class="string">'my-component'</span>,</span><br><span class="line">  template: <span class="string">'&lt;div&gt;A custom component!&lt;div @click.stop="toParent"&gt;test click&lt;/div&gt;&lt;/div&gt;'</span>,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Child:Child</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">created</span></span>()&#123;</span><br><span class="line">    console.log(this);</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="function"><span class="title">toParent</span></span>()&#123;</span><br><span class="line">      this.<span class="variable">$emit</span>(<span class="string">'componenton'</span>,<span class="string">'toParent'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">mounted</span></span>()&#123;</span><br><span class="line">    console.log(this);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">  new Vue(&#123;</span><br><span class="line">  el: <span class="string">'#app'</span>,</span><br><span class="line">  data: <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">    <span class="built_in">return</span> &#123;</span><br><span class="line">      heihei:&#123;name:3333&#125;,</span><br><span class="line">      a:1</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    Child:Child</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    <span class="function"><span class="title">click1</span></span>()&#123;</span><br><span class="line">      alert(<span class="string">'click1'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">click2</span></span>()&#123;</span><br><span class="line">      alert(<span class="string">'click2'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">nativeclick</span></span>()&#123;</span><br><span class="line">      alert(<span class="string">'nativeclick'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    parentOn(value)&#123;</span><br><span class="line">      alert(value)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>上面的demo中一共有四个事件。基本涵盖了vue中最经典的事件的四种情况</p>
<h2 id="普通html元素上的事件"><a href="#普通html元素上的事件" class="headerlink" title="普通html元素上的事件"></a>普通html元素上的事件</h2><p>首先我们看看最简单的第一、二个(两个事件只差了个修饰符)：<br><code>&lt;div id=&quot;test1&quot; @click=&quot;click1&quot;&gt;click1&lt;/div&gt;</code></p>
<p>我们来看看建立这么一个简单的点击事件，vue中发生了什么。</p>
<ol>
<li><code>new Vue()</code>中调用了<code>initState(vue)</code>:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> initState (vm) &#123;</span><br><span class="line">  vm._watchers = [];</span><br><span class="line">  var opts = vm.<span class="variable">$options</span>;</span><br><span class="line">  <span class="keyword">if</span> (opts.props) &#123; initProps(vm, opts.props); &#125;</span><br><span class="line">  <span class="keyword">if</span> (opts.methods) &#123; initMethods(vm, opts.methods); &#125;//初始化事件</span><br><span class="line">  <span class="keyword">if</span> (opts.data) &#123;</span><br><span class="line">    initData(vm);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    observe(vm._data = &#123;&#125;, <span class="literal">true</span> /* asRootData */);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (opts.computed) &#123; initComputed(vm, opts.computed); &#125;</span><br><span class="line">  <span class="keyword">if</span> (opts.watch) &#123; initWatch(vm, opts.watch); &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//接着看看initMethods</span><br><span class="line"><span class="keyword">function</span> initMethods (vm, methods) &#123;</span><br><span class="line">  var props = vm.<span class="variable">$options</span>.props;</span><br><span class="line">  <span class="keyword">for</span> (var key <span class="keyword">in</span> methods) &#123;</span><br><span class="line">    vm[key] = methods[key] == null ? noop : <span class="built_in">bind</span>(methods[key], vm);//调用了<span class="built_in">bind</span>方法，我们再看看<span class="built_in">bind</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (methods[key] == null) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          <span class="string">"method \""</span> + key + <span class="string">"\" has an undefined value in the component definition. "</span> +</span><br><span class="line">          <span class="string">"Did you reference the function correctly?"</span>,</span><br><span class="line">          vm</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (props &amp;&amp; hasOwn(props, key)) &#123;</span><br><span class="line">        warn(</span><br><span class="line">          (<span class="string">"method \""</span> + key + <span class="string">"\" has already been defined as a prop."</span>),</span><br><span class="line">          vm</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//我们接着看看<span class="built_in">bind</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="built_in">bind</span> (fn, ctx) &#123;</span><br><span class="line">  <span class="keyword">function</span> boundFn (a) &#123;</span><br><span class="line">    var l = arguments.length;</span><br><span class="line">    <span class="built_in">return</span> l</span><br><span class="line">      ? l &gt; 1</span><br><span class="line">        ? fn.apply(ctx, arguments)//通过返回函数修饰了事件的回调函数。绑定了事件回调函数的this。并且让参数自定义。更加的灵活</span><br><span class="line">        : fn.call(ctx, a)</span><br><span class="line">      : fn.call(ctx)</span><br><span class="line">  &#125;</span><br><span class="line">  // record original fn length</span><br><span class="line">  boundFn._length = fn.length;</span><br><span class="line">  <span class="built_in">return</span> boundFn</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>总的来说。<code>vue</code>初始化的时候，将<code>method</code>中的方法代理到<code>vue[key]</code>的同时修饰了事件的回调函数。绑定了作用域。</p>
<ol start="2">
<li><code>vue</code>进入<code>compile</code>环节需要将该<code>div</code>变成ast(抽象语法树）。当编译到该<code>div</code>时经过核心函数<code>genHandler</code>：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> genHandler (</span><br><span class="line">  name,</span><br><span class="line">  handler</span><br><span class="line">) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!handler) &#123;</span><br><span class="line">    <span class="built_in">return</span> <span class="string">'function()&#123;&#125;'</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (Array.isArray(handler)) &#123;</span><br><span class="line">    <span class="built_in">return</span> (<span class="string">"["</span> + (handler.map(<span class="keyword">function</span> (handler) &#123; <span class="built_in">return</span> genHandler(name, handler); &#125;).join(<span class="string">','</span>)) + <span class="string">"]"</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var isMethodPath = simplePathRE.test(handler.value);</span><br><span class="line">  var isFunctionExpression = fnExpRE.test(handler.value);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!handler.modifiers) &#123;</span><br><span class="line">    <span class="built_in">return</span> isMethodPath || isFunctionExpression//假如没有修饰符。直接返回回调函数</span><br><span class="line">      ? handler.value</span><br><span class="line">      : (<span class="string">"function(<span class="variable">$event</span>)&#123;"</span> + (handler.value) + <span class="string">"&#125;"</span>) // inline statement</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    var code = <span class="string">''</span>;</span><br><span class="line">    var genModifierCode = <span class="string">''</span>;</span><br><span class="line">    var keys = [];</span><br><span class="line">    <span class="keyword">for</span> (var key <span class="keyword">in</span> handler.modifiers) &#123;</span><br><span class="line">      <span class="keyword">if</span> (modifierCode[key]) &#123;</span><br><span class="line">        genModifierCode += modifierCode[key];//处理修饰符数组，例如.stop就在回调函数里加入event.stopPropagation()再返回。实现修饰的目的</span><br><span class="line">        // left/right</span><br><span class="line">        <span class="keyword">if</span> (keyCodes[key]) &#123;</span><br><span class="line">          keys.push(key);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        keys.push(key);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (keys.length) &#123;</span><br><span class="line">      code += genKeyFilter(keys);</span><br><span class="line">    &#125;</span><br><span class="line">    // Make sure modifiers like prevent and stop get executed after key filtering</span><br><span class="line">    <span class="keyword">if</span> (genModifierCode) &#123;</span><br><span class="line">      code += genModifierCode;</span><br><span class="line">    &#125;</span><br><span class="line">    var handlerCode = isMethodPath</span><br><span class="line">      ? handler.value + <span class="string">'($event)'</span></span><br><span class="line">      : isFunctionExpression</span><br><span class="line">        ? (<span class="string">"("</span> + (handler.value) + <span class="string">")(<span class="variable">$event</span>)"</span>)</span><br><span class="line">        : handler.value;</span><br><span class="line">    <span class="built_in">return</span> (<span class="string">"function(<span class="variable">$event</span>)&#123;"</span> + code + handlerCode + <span class="string">"&#125;"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><code>genHandler</code>函数简单明了，如果事件函数有修饰符。就处理完修饰符，添加修饰符对应的函数语句。再返回。这个过程还会单独对<code>native</code>修饰符做特殊处理。这个等会说。<code>compile</code>完后自然就<code>render</code>。我们看看<code>render</code>函数中这块区域长什么样子：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">_c(<span class="string">'div'</span>,&#123;</span><br><span class="line">     attrs:&#123;<span class="string">"id"</span>:<span class="string">"test1"</span>&#125;,</span><br><span class="line">     on:&#123;<span class="string">"click"</span>:click1&#125;</span><br><span class="line">     &#125;,</span><br><span class="line">     [_v(<span class="string">"click1"</span>)]</span><br><span class="line">),</span><br><span class="line">_v(<span class="string">" "</span>),</span><br><span class="line">_c(<span class="string">'div'</span>,&#123;</span><br><span class="line">     attrs:&#123;<span class="string">"id"</span>:<span class="string">"test2"</span>&#125;,</span><br><span class="line">     on:&#123;<span class="string">"click"</span>:<span class="keyword">function</span>(<span class="variable">$event</span>)&#123;</span><br><span class="line">                 <span class="variable">$event</span>.stopPropagation();</span><br><span class="line">                 click2(<span class="variable">$event</span>)&#125;</span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p>一目了然。最后在虚拟dom－&gt;真实dom的时候。会调用核心函数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> add<span class="variable">$1</span> (</span><br><span class="line">  event,</span><br><span class="line">  handler,</span><br><span class="line">  once$<span class="variable">$1</span>,</span><br><span class="line">  capture,</span><br><span class="line">  passive</span><br><span class="line">) &#123;</span><br><span class="line">  <span class="keyword">if</span> (once$<span class="variable">$1</span>) &#123;</span><br><span class="line">    var oldHandler = handler;</span><br><span class="line">    var _target = target<span class="variable">$1</span>; // save current target element <span class="keyword">in</span> closure</span><br><span class="line">    handler = <span class="keyword">function</span> (ev) &#123;</span><br><span class="line">      var res = arguments.length === 1</span><br><span class="line">        ? oldHandler(ev)</span><br><span class="line">        : oldHandler.apply(null, arguments);</span><br><span class="line">      <span class="keyword">if</span> (res !== null) &#123;</span><br><span class="line">        remove<span class="variable">$2</span>(event, handler, capture, _target);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  target<span class="variable">$1</span>.addEventListener(</span><br><span class="line">    event,</span><br><span class="line">    handler,</span><br><span class="line">    supportsPassive</span><br><span class="line">      ? &#123; capture: capture, passive: passive &#125;//此处绑定点击事件</span><br><span class="line">      : capture</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="组件上的事件"><a href="#组件上的事件" class="headerlink" title="组件上的事件"></a>组件上的事件</h2><p>组件上的点击事件和普通的html元素应该是不同的道路。事实也是如此：</p>
<p><code>&lt;my-component v-on:click.native=&quot;nativeclick&quot; v-on:componenton=&quot;parentOn&quot;&gt;&lt;/my-component&gt;</code></p>
<p>两个事件的区别就是一个有<code>.native</code>的修饰符。我们来看看官方<code>.native</code>的作用：在原生<code>dom</code>上绑定事件。<code>vue</code>中的组件都是扩展的<code>vue</code>的一个新实例。在<code>compile</code>结束的时候你还是可以发现他也是类似的一个样子。如下图：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">_c(<span class="string">'my-component'</span>,</span><br><span class="line">    &#123;</span><br><span class="line">       on:&#123;<span class="string">"componenton"</span>:parentOn&#125;,</span><br><span class="line">       nativeOn:&#123;<span class="string">"click"</span>:<span class="keyword">function</span>(<span class="variable">$event</span>)&#123;nativeclick(<span class="variable">$event</span>)&#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>可以看到加了<code>.native</code>修饰符的会被放入<code>nativeOn</code>的数组中。等待后续特殊处理。<code>render</code>函数在执行时。如果遇到组件。会执行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> createComponent (</span><br><span class="line">  Ctor,</span><br><span class="line">  data,</span><br><span class="line">  context,</span><br><span class="line">  children,</span><br><span class="line">  tag</span><br><span class="line">) &#123;</span><br><span class="line">  <span class="keyword">if</span> (isUndef(Ctor)) &#123;</span><br><span class="line">    <span class="built_in">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var baseCtor = context.<span class="variable">$options</span>._base;</span><br><span class="line"></span><br><span class="line">  // plain options object: turn it into a constructor</span><br><span class="line">  <span class="keyword">if</span> (isObject(Ctor)) &#123;</span><br><span class="line">    Ctor = baseCtor.extend(Ctor);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // <span class="keyword">if</span> at this stage it<span class="string">'s not a constructor or an async component factory,</span></span><br><span class="line"><span class="string">  // reject.</span></span><br><span class="line"><span class="string">  if (typeof Ctor !== '</span><span class="keyword">function</span><span class="string">') &#123;</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">      warn(("Invalid Component definition: " + (String(Ctor))), context);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  // async component</span></span><br><span class="line"><span class="string">  if (isUndef(Ctor.cid)) &#123;</span></span><br><span class="line"><span class="string">    Ctor = resolveAsyncComponent(Ctor, baseCtor, context);</span></span><br><span class="line"><span class="string">    if (Ctor === undefined) &#123;</span></span><br><span class="line"><span class="string">      // return nothing if this is indeed an async component</span></span><br><span class="line"><span class="string">      // wait for the callback to trigger parent update.</span></span><br><span class="line"><span class="string">      return</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  // resolve constructor options in case global mixins are applied after</span></span><br><span class="line"><span class="string">  // component constructor creation</span></span><br><span class="line"><span class="string">  resolveConstructorOptions(Ctor);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  data = data || &#123;&#125;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  // transform component v-model data into props &amp; events</span></span><br><span class="line"><span class="string">  if (isDef(data.model)) &#123;</span></span><br><span class="line"><span class="string">    transformModel(Ctor.options, data);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  // extract props</span></span><br><span class="line"><span class="string">  var propsData = extractPropsFromVNodeData(data, Ctor, tag);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  // functional component</span></span><br><span class="line"><span class="string">  if (isTrue(Ctor.options.functional)) &#123;</span></span><br><span class="line"><span class="string">    return createFunctionalComponent(Ctor, propsData, data, context, children)</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  // extract listeners, since these needs to be treated as</span></span><br><span class="line"><span class="string">  // child component listeners instead of DOM listeners</span></span><br><span class="line"><span class="string">  var listeners = data.on;//listeners缓存data.on的函数。这里就是componenton事件</span></span><br><span class="line"><span class="string">  // replace with listeners with .native modifier</span></span><br><span class="line"><span class="string">  data.on = data.nativeOn;//正常的data.on会被native修饰符的事件所替换</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  if (isTrue(Ctor.options.abstract)) &#123;</span></span><br><span class="line"><span class="string">    // abstract components do not keep anything</span></span><br><span class="line"><span class="string">    // other than props &amp; listeners</span></span><br><span class="line"><span class="string">    data = &#123;&#125;;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  // merge component management hooks onto the placeholder node</span></span><br><span class="line"><span class="string">  mergeHooks(data);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  // return a placeholder vnode</span></span><br><span class="line"><span class="string">  var name = Ctor.options.name || tag;</span></span><br><span class="line"><span class="string">  var vnode = new VNode(</span></span><br><span class="line"><span class="string">    ("vue-component-" + (Ctor.cid) + (name ? ("-" + name) : '</span><span class="string">')),</span></span><br><span class="line"><span class="string">    data, undefined, undefined, undefined, context,</span></span><br><span class="line"><span class="string">    &#123; Ctor: Ctor, propsData: propsData, listeners: listeners, tag: tag, children: children &#125;</span></span><br><span class="line"><span class="string">  );</span></span><br><span class="line"><span class="string">  return vnode</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>整段代码关于事件核心操作：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var listeners = data.on;  //listeners缓存data.on的函数。这里就是componenton事件</span><br><span class="line">// replace with listeners with .native modifier</span><br><span class="line">data.on = data.nativeOn;  //正常的data.on会被native修饰符的事件所替换</span><br></pre></td></tr></table></figure></p>
<p>经过这两句话。<code>.native</code>修饰符的事件会被放在<code>data.on</code>上面。接下来<code>data.on</code>上的事件（这里就是<code>nativeclick</code>）会按普通的<code>html</code>事件往下走。最后执行<code>target.add(&#39;&#39;,&#39;&#39;&#39;)</code>挂上原生的事件。而先前的<code>data.on</code>上的被缓存在<code>listeneners</code>的事件就没着么愉快了。接下来他会在组件<code>init</code>的时候。它会进入一下分支：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> initEvents (vm) &#123;</span><br><span class="line">  vm._events = Object.create(null);</span><br><span class="line">  vm._hasHookEvent = <span class="literal">false</span>;</span><br><span class="line">  // init parent attached events</span><br><span class="line">  var listeners = vm.<span class="variable">$options</span>._parentListeners;</span><br><span class="line">  <span class="keyword">if</span> (listeners) &#123;</span><br><span class="line">    updateComponentListeners(vm, listeners);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> updateComponentListeners (</span><br><span class="line">  vm,</span><br><span class="line">  listeners,</span><br><span class="line">  oldListeners</span><br><span class="line">) &#123;</span><br><span class="line">  target = vm;</span><br><span class="line">  updateListeners(listeners, oldListeners || &#123;&#125;, add, remove<span class="variable">$1</span>, vm);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> add (event, fn, once$<span class="variable">$1</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (once$<span class="variable">$1</span>) &#123;</span><br><span class="line">    target.<span class="variable">$once</span>(event, fn);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    target.<span class="variable">$on</span>(event, fn);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>发现组件上的没有<code>.native</code>的修饰符调用的是<code>$on</code>方法。这个好熟悉。进入到<code>$on</code>,<code>$emit</code>大致想到是一个典型的观察者模式的事件。看看相关<code>$on</code>,<code>$emit</code>代码。我加点注解：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype.<span class="variable">$on</span> = <span class="keyword">function</span> (event, fn) &#123;</span><br><span class="line">    var this<span class="variable">$1</span> = this;</span><br><span class="line"></span><br><span class="line">    var vm = this;</span><br><span class="line">    <span class="keyword">if</span> (Array.isArray(event)) &#123;</span><br><span class="line">      <span class="keyword">for</span> (var i = 0, l = event.length; i &lt; l; i++) &#123;</span><br><span class="line">        this<span class="variable">$1</span>.<span class="variable">$on</span>(event[i], fn);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      (vm._events[event] || (vm._events[event] = [])).push(fn);//存入事件</span><br><span class="line">      // optimize hook:event cost by using a boolean flag marked at registration</span><br><span class="line">      // instead of a <span class="built_in">hash</span> lookup</span><br><span class="line">      <span class="keyword">if</span> (hookRE.test(event)) &#123;</span><br><span class="line">        vm._hasHookEvent = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">return</span> vm</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">Vue.prototype.<span class="variable">$emit</span> = <span class="keyword">function</span> (event) &#123;</span><br><span class="line">    var vm = this;</span><br><span class="line">    console.log(vm);</span><br><span class="line">    &#123;</span><br><span class="line">      var lowerCaseEvent = event.toLowerCase();</span><br><span class="line">      <span class="keyword">if</span> (lowerCaseEvent !== event &amp;&amp; vm._events[lowerCaseEvent]) &#123;</span><br><span class="line">        tip(</span><br><span class="line">          <span class="string">"Event \""</span> + lowerCaseEvent + <span class="string">"\" is emitted in component "</span> +</span><br><span class="line">          (formatComponentName(vm)) + <span class="string">" but the handler is registered for \""</span> + event + <span class="string">"\". "</span> +</span><br><span class="line">          <span class="string">"Note that HTML attributes are case-insensitive and you cannot use "</span> +</span><br><span class="line">          <span class="string">"v-on to listen to camelCase events when using in-DOM templates. "</span> +</span><br><span class="line">          <span class="string">"You should probably use \""</span> + (hyphenate(event)) + <span class="string">"\" instead of \""</span> + event + <span class="string">"\"."</span></span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    var cbs = vm._events[event];</span><br><span class="line">    console.log(cbs);</span><br><span class="line">    <span class="keyword">if</span> (cbs) &#123;</span><br><span class="line">      cbs = cbs.length &gt; 1 ? toArray(cbs) : cbs;</span><br><span class="line">      var args = toArray(arguments, 1);</span><br><span class="line">      <span class="keyword">for</span> (var i = 0, l = cbs.length; i &lt; l; i++) &#123;</span><br><span class="line">        cbs[i].apply(vm, args);／／当emit的时候调用该事件。注意上面说的vue在初始化的守候。用<span class="built_in">bind</span>修饰了事件函数。所以组件上挂载的事件都是在父作用域中的</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">return</span> vm</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure></p>
<p>看了上面的<code>on</code>,<code>emit</code>用法下面这个<code>demo</code>也就瞬间秒解了（一个经常用的非父子组件通信）：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var bus = new Vue()</span><br><span class="line">// 触发组件 A 中的事件</span><br><span class="line">bus.<span class="variable">$emit</span>(<span class="string">'id-selected'</span>, 1)</span><br><span class="line">// 在组件 B 创建的钩子中监听事件</span><br><span class="line">bus.<span class="variable">$on</span>(<span class="string">'id-selected'</span>, <span class="keyword">function</span> (id) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>总的来说。vue对于事件有两个底层的处理逻辑。</p>
<ul>
<li>普通html元素和在组件上挂了<code>.native</code>修饰符的事件。最终<code>EventTarget.addEventListener()</code>挂载事件</li>
<li>组件上的，<code>vue</code>实例上的事件会调用原型上的<code>$on</code>,<code>$emit</code>（包括一些其他api <code>$off</code>,<code>$once</code>等等）</li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/笔记/" rel="tag"># 笔记</a>
          
            <a href="/tags/JavaScript/" rel="tag"># JavaScript</a>
          
            <a href="/tags/vue/" rel="tag"># vue</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/01/22/vue源码阅读-prop机制/" rel="next" title="vue源码阅读-prop机制">
                <i class="fa fa-chevron-left"></i> vue源码阅读-prop机制
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/01/22/vue双向绑定的实现原理/" rel="prev" title="vue双向绑定的实现原理">
                vue双向绑定的实现原理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/my.jpg"
                alt="Aishlily" />
            
              <p class="site-author-name" itemprop="name">Aishlily</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">49</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Aishlily" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:mali_job@yeah.net" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#事件机制demo："><span class="nav-number">1.</span> <span class="nav-text">事件机制demo：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#普通html元素上的事件"><span class="nav-number">2.</span> <span class="nav-text">普通html元素上的事件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#组件上的事件"><span class="nav-number">3.</span> <span class="nav-text">组件上的事件</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Aishlily</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  
  <script type="text/javascript" src="/js/src/exturl.js?v=5.1.4"></script>


</body>
</html>
<script type="text/javascript" src="/js/src/love.js"></script>>